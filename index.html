<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AR Switch 3Com 24 puertos</title>

    <!-- A-Frame y AR.js -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar-js@3.3.2/aframe/build/aframe-ar.js"></script>
    <script src="https://unpkg.com/tabletop@1.7.1/dist/tabletop.min.js"></script>

    <style>
      body { margin: 0; overflow: hidden; font-family: sans-serif; }
      a-scene { position: fixed; width: 100%; height: 100%; top: 0; left: 0; }
    </style>
  </head>
  <body>
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
      <!-- Usando tu archivo personalizado pattern-hiro.patt -->
      <a-marker type="pattern" url="pattern-hiro.patt">
        <a-entity id="labels"></a-entity>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      const publicSpreadsheetUrl =
        'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ6DAEEHm3ocTEaACuWPXDpuDy47769-LKG2GvCk8u8DHNyGzapDxGiIoLJQ_uCDRFCWEQhAUp89RL6/pubhtml';

      function showInfo(data) {
        console.log("âœ… Datos cargados:", data);
        const labels = document.getElementById('labels');
        labels.innerHTML = '';

        const r = 1.5;
        const total = 24;

        data.forEach(row => {
          const puerto = parseInt(row.Puerto);
          if (!row.IP) return;

          const tipo = row.Tipo;
          const ip = row.IP;

          const ang = (puerto - 1) * (360 / total);
          const rad = (Math.PI / 180) * ang;
          const x = r * Math.cos(rad);
          const z = r * Math.sin(rad);

          const text = document.createElement('a-text');
          text.setAttribute('value', `[${puerto}] ${ip} (${tipo})`);
          text.setAttribute('position', `${x.toFixed(2)} 0.5 ${z.toFixed(2)}`);
          text.setAttribute('rotation', `-90 ${-ang} 0`);
          text.setAttribute('color', '#00FF00');
          text.setAttribute('align', 'center');
          text.setAttribute('side', 'double');
          text.setAttribute('scale', '1.5 1.5 1.5');
          labels.appendChild(text);
        });
      }

      function init() {
        Tabletop.init({
          key: publicSpreadsheetUrl,
          simpleSheet: true,
          callback: showInfo
        });
      }

      window.addEventListener('DOMContentLoaded', init);
    </script>
  </body>
</html>
